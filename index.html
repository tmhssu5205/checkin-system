<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>å®æ—¶ç­¾åˆ°çœ‹æ¿</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
        body { font-family: Arial; padding: 20px; }
        .card { 
            background: #f5f5f5;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            display: inline-block;
        }
        #refreshBtn {
            padding: 10px 20px;
            background: #4285f4;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h2>å®æ—¶ç­¾åˆ°çŠ¶æ€ âœ…</h2>
    <button id="refreshBtn">åˆ·æ–°æ•°æ®</button>
    <div id="dataContainer"></div>

<script>
// æ›¿æ¢ä¸ºä½ çš„ Google Sheets å…¬å¼€åˆ†äº«é“¾æ¥ï¼ˆå‘å¸ƒåˆ°ç½‘é¡µï¼‰
const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSUMo5HEZuyyqccCudigtvKu1cXMDm0EnjoOLeLJDCTuHjBcomd1v8AXZZDa9f07-DsETrnI60Id1Ha/pubhtml';

async function loadData() {
    try {
        const res = await fetch(SHEET_URL);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        
        let html = '';
        json.table.rows.slice(1).forEach(row => { // è·³è¿‡è¡¨å¤´
            const [time, name, location] = row.c;
            html += `
                <div class="card">
                    <h3>${location.v}</h3>
                    <p>ğŸ‘¤ ${name.v}</p>
                    <small>ğŸ•’ ${new Date(time.v).toLocaleString()}</small>
                </div>
            `;
        });
        
        document.getElementById('dataContainer').innerHTML = html;
    } catch (err) {
        console.error('åŠ è½½æ•°æ®å¤±è´¥:', err);
    }
}

// é¦–æ¬¡åŠ è½½ + æŒ‰é’®ç‚¹å‡»åˆ·æ–° + æ¯30ç§’è‡ªåŠ¨åˆ·æ–°
document.getElementById('refreshBtn').addEventListener('click', loadData);
setInterval(loadData, 30000);
loadData();
</script>
</body>
</html>